# WebAudioFont

WebAudioFont is a set of resources and associated technology that uses sample-based synthesis to play musical instruments in browser.
You can use about of thousands of instrument, see [Catalog](#catalog-of-instruments).

### Code examples

- simple example - [code](http://jsbin.com/lamidog/1/edit?html,output) - [open](https://surikov.github.io/webaudiofont/examples/simple.html)
- virtual drums - [code](http://jsbin.com/wajopuy/1/edit?html,output) - [open](https://surikov.github.io/webaudiofont/examples/drums.html)
- virtual piano - [code](http://jsbin.com/binelu/1/edit?html,output) - [open](https://surikov.github.io/webaudiofont/examples/piano.html)
- endless flute - [code](http://jsbin.com/midadem/1/edit?html,output) - [open](https://surikov.github.io/webaudiofont/examples/flute.html)
- two voices - [code](http://jsbin.com/vujewem/1/edit?html,output) - [open](https://surikov.github.io/webaudiofont/examples/voices.html)
- sound fx - [code](http://jsbin.com/tipine/1/edit?html,output) - [open](https://surikov.github.io/webaudiofont/examples/fx.html)
- realtime music - [code](https://jsbin.com/wuxilab/2/edit?html,output) - [open](https://surikov.github.io/webaudiofont/examples/realtime.html)
- dynamic loading - [open](https://surikov.github.io/webaudiofont/examples/dynamic.html)
- mixer, equalizer and reverberation - [open](https://surikov.github.io/webaudiofont/examples/mixer.html)
- custom AHDSR envelope - [open](https://surikov.github.io/webaudiofont/examples/ahdsr.html)
- strum chord - [open](https://surikov.github.io/webaudiofont/examples/strum.html)
- MIDI keyboard - [open](https://surikov.github.io/webaudiofont/examples/midikey.html)
- MIDI player - [open](https://surikov.github.io/webaudiofont/examples/midiplayer.html)

### Example applications

- [3D music sequencer](https://surikov.github.io/riffshare/parse.html?riff=8c-0000243a-a1657060-0e0d080c0d0e0706050f-00110111021103110411051106110711081109110a110b110c110d110e110f1110111111121113111411151116111711181119111a111b111c111d111e111f113099319f328f339e348f359e369f379e3899399f3a8f3b9e3c8f3d9e3e9f3f9e4099419942994399449f459f469f4799489949994a994b994c9f4d9f4e9f4f995099519f5299539f5499559f5699571f5899599f5a995b9f5c995d9f5e995f1f80118111821183118411851186118711881189118a118b118c118d118e118f1190119111921193119411951196119711981199119a119b119c119d119e119f11c011c111c211c311c411c511c611c711c811c911ca11cb11cc11cd11ce11cf11d011d111d211d311d411d511d611d711d811d911da11db11dc11dd11de11df11-004023040005020040007030040024022b40027020c40037020740044022740045040740047030040054022b40067020c400740224400770207400850200400870300400a7020c400b70207400c40230400c50407400c70200400d70200400e4022e400e70207400f7020c40104023040105030040107030040124022b40127020c40137020740144022740145040740147030040154022b40167020c401740224401770207401850300401870300401a7020c401b70207401c40230401c50407401c70200401d70200401e40232401e70207401f7020c40204023340205030040207030040224023240227020c40234023340237020740245040040247020040254023340257020040267020740274023040277020c40284023240285030a40287030a402a40230402a7020a402b40232402b70205402c5030a402c7020a402d40232402d7020a402e70205402f4022e402f7020a40304023040305030840307030840324022e40327020840334023040337020340345040840347020840354023040357020840367020340374022c403770208403840230403850400403870300403a7020c403b70205403c40230403c50407403c70200403d70200403e4022e403e70205403f7020c40404023040405030040407030040424022b40427020c40437020740444022740445040740447030040454022b40467020c404740224404770207404850400404870300404a7020c404b70207404c40230404c50407404c70200404d70200404e4022e404e70207404f7020c40504023040505040040507030040524022b40527020c40537020740544022740545040740547030040554022b40567020c405740224405770207405850300405870300405a7020c405b70207405c40230405c50407405c70200405d70200405e40232405e70207405f7020c40604023340605030040607030040624023240627020c40634023340637020740645040040647020040654023340657020040667020740674023040677020c40684023240685030a40687030a406a40230406a7020a406b40232406b70205406c5040a406c7020a406d40232406d7020a406e70205406f4022e406f7020a40704023040705030840707030840724022e407270208407340230407370203407450408407470208407540230407570208407670203407740232407770208407840233407850300407870303407a7020f407b7020a407c40237407c50300407c70203407d70203407e40235407e7020a407f7020f408040237408050303408060f2240807030340824023340827020f40837020a40844022e40845030a40847030340854023340867020f40874022b40877020a408850303408870303408a7020f408b7020a408c40237408c5030a408c70203408d70203408e40235408e60321408e7020a408f7020f40904023740905030340906052240907030340924023340927020f40937020a40944022e40945030a40946091f40947030340954023340967020f40974022b40977020a409850303409870303409a7020f409b7020a409c40237409c5040a409c60322409c70203409d70203409e40239409e60324409e7020a409f7020f40a04023a40a05030740a06072640a07030740a24023940a27021340a34023a40a37020e40a45040740a47020740a54023a40a57020740a66032240a67020e40a74023740a77021340a84023940a85040540a86072440a87030540aa4023740aa7021140ab4023940ab7020c40ac5040540ac7020540ad4023940ad7020540ae6032140ae7020c40af4023540af7021140b04023740b05030340b06112240b07030340b24023540b27020f40b34023740b37020a40b45030a40b47020340b54023740b57020340b67020a40b74023340b77020f40b84023740b85030340b87030340ba7020f40bb7020a40bc4023740bc5030a40bc7020340bd7020340be4023540be7020a40bf7020f40c04023740c05030340c060f2240c07030340c24023340c27020f40c37020a40c44022e40c45040a40c47030340c54023340c67020f40c74022b40c77020a40c85030340c87030340ca7020f40cb7020a40cc4023740cc5030a40cc7020340cd7020340ce4023540ce6032140ce7020a40cf7020f40d04023740d05030340d06052240d07030340d24023340d27020f40d37020a40d44022e40d45030a40d46091f40d47030340d54023340d67020f40d74022b40d77020a40d85030340d87030340da7020f40db7020a40dc4023740dc5030a40dc6032240dc7020340dd7020340de4023940de6032440de7020a40df7020f40e04023a40e05030740e06072640e07030740e24023940e27021340e34023a40e37020e40e45030740e47020740e54023a40e57020740e66032240e67020e40e74023740e77021340e84023940e85030540e86072440e87030540ea4023740ea7021140eb4023940eb7020c40ec5030540ec7020540ed4023940ed7020540ee6032140ee7020c40ef4023540ef7021140f04023740f05040340f06082240f07030340f24023540f27020f40f34023240f37020a40f45030340f47020340f54023240f57020340f64023540f66031f40f67020a40f77020f40f84023740f85030040f86092240f87030040fa7020c40fb7020740fc4023040fc5040040fc7020040fd7020040fe4022e40fe7020740ff7020c40)
- [Pianoroll editor](https://surikov.github.io/RiffShareAndroid/app/src/main/assets/load.html?riff=78-35525525-55955559-0d0d0c0704100f0e070c-0009010302090303040905030609070327c040104110421043104410451046104708673080608166826683668466856686668706a010a111a211a311a411a511a611a701e001-005030c40006102440006102740006102b40002031840000030c40035030c40032031b40033030c40065030c40062081f40060030c40095030c40093030c400c5040c400c0040c400e2041f40105030540106102440106102740106102940100030540122061b40135030540133030540165030540160030540182021b401950305401930305401a2061d401c50405401c0040540205030840206102440206102740206102b40202031840200030840235030840232031b40233030840265030840262081f402600308402950308402930308402c50408402c00408402e2041f40305030a40306102440306102740306102c40300030a40322061b40335030a40333030a40365030a40360030a40382021b40395030a40393030a403a2061d403c5040a403c0040a40)
- [Fretboard for chords](https://surikov.github.io/RiffShareAndroid/app/src/main/assets/fretload.html?riff=1-120-035110e4020c4120a411064110741108411094110c3320c2320e3020e202034310333106331062310733107231083310823109331092310a2310a3311354113461133611644116361162611744118441194411c4421e4421c3621c2621e2621e3621736117261183611826119361192610051300433003330433204432045121054310463103631454214462143621a2611a3611a441-0001002222100010000100222210000)
- [Lyrics editor](http://molgav.nn.ru/textchord/)

#### Use cases

- Virtual instruments
- Interactive music generated on the fly
- Sound effects for non-music applications

#### Content

- [How to use](#how-to-use)
  - [Hello, world](#hello-world)
  - [Dynamic loading](#dynamic-loading)
  - [Effects and mixer](#effects-and-mixer)
  - [Custom samples](#custom-samples)
- [Installation](#installation)
  - for [ReactJS](#reactjs)
- [Parts of WebAudioFont](#parts-of-webaudiofont)
  - [Catalog of instruments](#catalog-of-instruments)
  - [Player](#player)
- [How to get help](#how-to-get-help)

## How to use

Add link to WebAudioFontPlayer.js and instrument file. Invoke queueWaveTable.

### Hello, world

Minimal HTML page

```html
<html>
	<head>
		<script src='https://surikov.github.io/webaudiofont/npm/dist/WebAudioFontPlayer.js'></script>
		<script src='https://surikov.github.io/webaudiofontdata/sound/0250_SoundBlasterOld_sf2.js'></script>
		<script>
			var AudioContextFunc = window.AudioContext || window.webkitAudioContext;
			var audioContext = new AudioContextFunc();
			var player=new WebAudioFontPlayer();
			player.loader.decodeAfterLoading(audioContext, '_tone_0250_SoundBlasterOld_sf2');
			function play(){
				player.queueWaveTable(audioContext, audioContext.destination
					, _tone_0250_SoundBlasterOld_sf2, 0, 12*4+7, 2);
				return false;
			}
		</script>
	</head>
	<body>
		<p><a href='javascript:play();'>Hello, world!</a></p>
	</body>
</html>
```

### Dynamic loading

Use startLoad and waitLoad functions.

```javascript
var instr=null;
var AudioContextFunc = window.AudioContext || window.webkitAudioContext;
var audioContext = new AudioContextFunc();
var player=new WebAudioFontPlayer();
function changeInstrument(path,name){
	player.loader.startLoad(audioContext, path, name);
	player.loader.waitLoad(function () {
		instr=window[name];
	});
}
changeInstrument('https://surikov.github.io/webaudiofontdata/sound/0290_Aspirin_sf2_file.js','_tone_0290_Aspirin_sf2_file');
```

All loaded instrument cached in memory.

See [live example](https://surikov.github.io/webaudiofont/examples/dynamic.html)

### Effects and mixer

Use WebAudioFontChannel to create chain of 10-band equalizers.
Use WebAudioFontReverberator to add echo.

See [live example](https://surikov.github.io/webaudiofont/examples/mixer.html)

### Custom samples

See [tutorial](https://surikov.github.io/webaudiofont/examples/customsample.html)

## Installation

WebAudioFont doesn't require installation. It hosts all code and instruments at [GitHub Pages](https://pages.github.com/).

### Minimal NPM code (if you need this)

#### JavaScript

```javascript
var webaudiofont = require('webaudiofont');
var player = new WebAudioFontPlayer();
```

#### package.json

```
...
"devDependencies": {
	"webaudiofont":"^2.5.0"
...
```

## Parts of WebAudioFont

WebAudioFont uses [Web Audio API](https://www.google.ru/search?q=web+audio+api) to play instruments.
Synthesizer uses [wavetables](https://www.google.ru/search?q=wavetable+synthesis) to play sound.
Instruments came from free soundfonts:

- [GeneralUserGS.sf2 license](http://www.schristiancollins.com/generaluser.php)
- [FluidR3.sf2 license](https://github.com/musescore/MuseScore/blob/master/share/sound/FluidR3Mono_License.md)

### Catalog of instruments

The catalog consists of a full set of MIDI standard. Each instrument has 5-10 sound variations from different soundfonts.

#### How to use catalog of sounds:

- open [index page](https://surikov.github.io/webaudiofontdata/sound/)
- find instrument
- copy name of file to include instrument data
- copy name of variable to refer to instrument
- add this info to a page

Use drumInfo and instrumentInfo in realtime. See [live example](https://surikov.github.io/webaudiofont/examples/dynamic.html).

### Player

WebAudioFontPlayer has function queueWaveTable(audioContext, target, preset, when, pitch, duration, volume, slides)

Parameters:

- audioContext - AudioContext
- target - a node to connect, for example audioContext.destination
- preset - variable with instrument preset
- when - when to play, audioContext.currentTime or 0 to play now, audioContext.currentTime + 3 to play after 3 seconds
- pitch - note pitch from 0 to 127, for example 2+12*4 to play D of fourth octave (use MIDI key for drums)
- duration - note duration in seconds, for example 4 to play 4 seconds
- volume - 0.0 <=1.0 volume (0 is 'no value', 'no value' is 1)
- slides - array of pitch bends

Function queueWaveTable returns envelope object. You can use this object to cancel sound or access to AudioBufferSourceNode.

#### Strumming

Use queueChord, queueStrumUp, queueStrumDown, queueSnap for chords. See [live example](https://surikov.github.io/webaudiofont/examples/strum.html).

## How to get help

Feel free to ask any help at [project issues](https://github.com/surikov/webaudiofont/issues).

## ReactJS

See [ReactJS implementation](https://www.npmjs.com/package/midi-sounds-react).

### License

see [LICENSE.md](https://github.com/surikov/webaudiofont/blob/master/LICENSE.md).







